# Chapter 1: åº”ç”¨ç¨‹åºç”Ÿå‘½å‘¨æœŸç®¡ç†


æƒ³è±¡ä½ çš„åº”ç”¨æ˜¯ä¸€ä½å¯çˆ±çš„ç”µå­å® ç‰© ğŸ±ã€‚ä»æŒ‰ä¸‹å¼€æœºé”®çš„é‚£ä¸€åˆ»å¼€å§‹ï¼Œå®ƒéœ€è¦ç»å†ï¼šå”¤é†’(åˆå§‹åŒ–)â†’ç©è€(è¿è¡Œ)â†’ç¡è§‰(å…³é—­)ã€‚è¿™å°±æ˜¯**åº”ç”¨ç¨‹åºç”Ÿå‘½å‘¨æœŸç®¡ç†**è¦è´Ÿè´£çš„å®Œæ•´æµç¨‹ï¼

## ä¸ºä»€ä¹ˆéœ€è¦ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Ÿ

å°±åƒå»ºé€ æˆ¿å­éœ€è¦ç›‘ç†ä¸€æ ·ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ª"ç®¡å®¶"æ¥ç¡®ä¿ï¼š

1. **å¯åŠ¨æ—¶**ï¼šæ­£ç¡®åŠ è½½æ‰€æœ‰èµ„æº(XAML/é…ç½®)
2. **è¿è¡Œæ—¶**ï¼šåˆ›å»ºä¸»çª—å£å¹¶å‡†å¤‡æ•°æ®
3. **é€€å‡ºæ—¶**ï¼šå®‰å…¨ä¿å­˜çŠ¶æ€å’Œæ¸…ç†

è§‚å¯Ÿä¸‹é¢è¿™ä¸ªæœ€ç®€å•çš„ä¾‹å­ï¼š

```csharp
public override void Initialize()
{
    // è¿™é‡Œåƒå‡†å¤‡é£Ÿæçš„é˜¶æ®µ
    AvaloniaXamlLoader.Load(this); // åŠ è½½XAMLç•Œé¢é…æ–¹
}
```

> ğŸ’¡ ç±»æ¯”ï¼šå°±åƒåšèœå‰è¦å…ˆå¤‡é½é£Ÿæï¼Œè¿™é‡ŒåŠ è½½äº†æ‰€æœ‰ç•Œé¢è®¾è®¡(XAMLæ–‡ä»¶)

## å…³é”®ç”Ÿå‘½é˜¶æ®µè§£æ

```mermaid
sequenceDiagram
    participant A as åº”ç”¨å¯åŠ¨
    participant B as åˆå§‹åŒ–å®Œæˆ
    participant C as ä¸»çª—å£åˆ›å»º
    A->>B: Initialize() èµ„æºåŠ è½½
    B->>C: OnFrameworkInitializationCompleted()
    C->>B: æ˜¾ç¤ºä¸»ç•Œé¢
```

### 1. åˆå§‹åŒ–é˜¶æ®µ
```csharp
public override void Initialize()
{
    AvaloniaXamlLoader.Load(this); // åŠ è½½æ‰€æœ‰XAMLç•Œé¢
    base.Initialize(); // è°ƒç”¨çˆ¶ç±»åˆå§‹åŒ–
}
```
- `AvaloniaXamlLoader`ï¼šå°±åƒæ‹†å¼€ä¹é«˜åŒ…è£…ï¼ŒæŠŠé›¶ä»¶éƒ½å€’å‡ºæ¥
- è¿™ä¸ªæ–¹æ³•å¿…é¡»æœ€å…ˆè°ƒç”¨ï¼

### 2. æ¡†æ¶å°±ç»ªé˜¶æ®µ
å½“åŸºç¡€æ¡†æ¶å‡†å¤‡å¥½åï¼š

```csharp
public override void OnFrameworkInitializationCompleted()
{
    if (ApplicationLifetime is IClassicDesktopStyleApplicationLifetime desktop)
    {
        desktop.MainWindow = new MainWindow(); // åˆ›å»ºä¸»çª—å£
    }
    base.OnFrameworkInitializationCompleted(); // é‡è¦ï¼
}
```

> âš ï¸ æ³¨æ„ï¼š`base.OnFrameworkInitializationCompleted()` å¿…é¡»è°ƒç”¨ï¼Œå°±åƒåšå®Œèœè¦å…³ç…¤æ°”ä¸€æ ·é‡è¦ï¼

## ä¾èµ–æ³¨å…¥ç‰ˆæœ¬å¯¹æ¯”

ä¼ ç»Ÿæ–¹å¼ç›´æ¥`new`å¯¹è±¡ï¼š
```csharp
desktop.MainWindow = new MainWindow() {
    DataContext = new MainWindowViewModel() // ç›´æ¥åˆ›å»ºå®ä¾‹
};
```

ä½¿ç”¨[ä¾èµ–æ³¨å…¥å®¹å™¨](02_ä¾èµ–æ³¨å…¥å®¹å™¨_.md)çš„æ›´ä¼˜é›…æ–¹å¼ï¼š
```csharp
var mainWindow = Program.ServiceProvider?.GetRequiredService<MainWindow>();
var mainViewModel = Program.ServiceProvider?.GetRequiredService<MainWindowViewModel>();
mainWindow.DataContext = mainViewModel;
```

ä¼˜åŠ¿ï¼š
- å¯¹è±¡åˆ›å»ºäº¤ç»™ä¸“ä¸šå®¹å™¨ç®¡ç†
- æ–¹ä¾¿è¿›è¡Œå•å…ƒæµ‹è¯•
- è‡ªåŠ¨è§£å†³ä¾èµ–å…³ç³»

## å®æˆ˜å°æŠ€å·§

å…³é—­é»˜è®¤æ•°æ®éªŒè¯ï¼ˆé˜²æ­¢å†²çªï¼‰ï¼š
```csharp
private void DisableAvaloniaDataAnnotationValidation()
{
    // ç§»é™¤å†…ç½®çš„æ•°æ®æ³¨è§£éªŒè¯
    var pluginsToRemove = BindingPlugins.DataValidators
        .OfType<DataAnnotationsValidationPlugin>()
        .ToArray();
    
    foreach (var plugin in pluginsToRemove)
    {
        BindingPlugins.DataValidators.Remove(plugin);
    }
}
```
> ğŸ”§ ä½œç”¨ï¼šå½“æˆ‘ä»¬ä½¿ç”¨[é¡µé¢è§†å›¾æ¨¡å‹åŸºç±»](06_é¡µé¢è§†å›¾æ¨¡å‹åŸºç±»_.md)æ—¶é¿å…éªŒè¯å†²çª

## æ€»ç»“

ä»Šå¤©æˆ‘ä»¬å­¦ä¼šäº†ï¼š
- åº”ç”¨ç”Ÿå‘½å‘¨æœŸçš„ä¸‰å¤§é˜¶æ®µ ğŸ“ˆ
- åˆå§‹åŒ–èµ„æºçš„æ­£ç¡®æ–¹å¼ ğŸ§°
- ä¸»çª—å£åˆ›å»ºçš„æœ€ä½³å®è·µ ğŸ–¼ï¸
- éªŒè¯å†²çªçš„è§£å†³æ–¹æ³• âš”ï¸

æ¥ä¸‹æ¥æˆ‘ä»¬è¦è®¤è¯†åº”ç”¨èƒŒåçš„é­”åŠ›å¸ˆï¼š[ä¾èµ–æ³¨å…¥å®¹å™¨](02_ä¾èµ–æ³¨å…¥å®¹å™¨_.md)ï¼Œå®ƒä¼šå¸®æˆ‘ä»¬è‡ªåŠ¨ç®¡ç†æ‰€æœ‰å¯¹è±¡çš„ç”Ÿäº§çº¿ï¼

---

Generated by [AI Codebase Knowledge Builder](https://github.com/The-Pocket/Tutorial-Codebase-Knowledge)