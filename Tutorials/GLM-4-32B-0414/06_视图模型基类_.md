# Chapter 6: è§†å›¾æ¨¡å‹åŸºç±»

æ¬¢è¿å›åˆ°æˆ‘ä»¬çš„å­¦ä¹ æ—…ç¨‹ï¼åœ¨ä¸Šä¸€ç« æˆ‘ä»¬æ¢ç´¢äº†[é¡µé¢è§†å›¾æ¨¡å‹](05_é¡µé¢è§†å›¾æ¨¡å‹_.md)çš„å…·ä½“å®ç°åï¼Œä»Šå¤©æˆ‘ä»¬è¦è®¤è¯†ä¸€ä¸ªè®©æ‰€æœ‰ViewModeléƒ½å˜å¾—æ›´å¼ºå£®çš„"åŠŸå¤«å¸ˆçˆ¶"â€”â€”è§†å›¾æ¨¡å‹åŸºç±»ã€‚

## ä¸ºä»€ä¹ˆéœ€è¦åŸºç±»ï¼Ÿ

æƒ³è±¡æ­¦ä¾ ä¸–ç•Œé‡Œçš„é—¨æ´¾ï¼š
- ğŸ¯ å°‘æ—å¯ºæœ‰72ç»æŠ€ï¼ˆå…¬å…±åŠŸèƒ½ï¼‰
- ğŸ§‘â€ğŸ“ æ¯ä¸ªå¼Ÿå­ï¼ˆå…·ä½“ViewModelï¼‰éƒ½ä»åŸºç¡€åŠŸæ³•ç»ƒèµ·
- ğŸ’ª èŠ‚çœä¿®ç‚¼æ—¶é—´ï¼Œä¿è¯æ­¦åŠŸè·¯æ•°ä¸€è‡´

è§†å›¾æ¨¡å‹åŸºç±»å°±æ˜¯è¿™æ ·çš„**é—¨æ´¾ç§˜ç±**ï¼Œå®ƒä¸ºæ‰€æœ‰ViewModelæä¾›ï¼š

- ğŸ“œ æ ‡å‡†åŒ–çš„æ­¦åŠŸå¿ƒæ³•ï¼ˆé€šç”¨å±æ€§/æ–¹æ³•ï¼‰
- âš¡ å³æ—¶é€šçŸ¥æ›´æ–°çš„å†…åŠ›ï¼ˆ`ObservableObject`èƒ½åŠ›ï¼‰
- ğŸ§© ç»Ÿä¸€çš„è¡Œä¸ºæ¥å£ï¼ˆåç»­æ‰©å±•åŸºç¡€åŠŸèƒ½ï¼‰

```mermaid
pie
    title è§†å›¾æ¨¡å‹åŸºç±»çš„ä»·å€¼
    "ä»£ç å¤ç”¨" : 45
    "è¡Œä¸ºç»Ÿä¸€" : 30
    "æ‰©å±•åŸºç¡€" : 25
```

## è§£å‰–åŸºç¡€åŠŸæ³•

### 1. æ ¸å¿ƒèƒ½åŠ›ç»§æ‰¿

å°±åƒå¼Ÿå­ä»¬éƒ½è¦å­¦æ‰é©¬æ­¥ï¼š

```csharp
// ViewModelBase.cs
public class ViewModelBase : ObservableObject 
{
    // æ‰€æœ‰å­ç±»è‡ªåŠ¨è·å¾—å¯è§‚å¯Ÿèƒ½åŠ›ï¼
}
```

å…³é”®ç‚¹ï¼š
- `ObservableObject`ï¼šæä¾›äº†å±æ€§å˜æ›´é€šçŸ¥çš„"å†…åŠŸ"
- ç»§æ‰¿åè‡ªåŠ¨è·å¾—ï¼š`SetProperty`ã€`OnPropertyChanged`ç­‰æ–¹æ³•

### 2. å®é™…åº”ç”¨ç¤ºä¾‹

çœ‹çœ‹å…·ä½“é¡µé¢å¦‚ä½•"æ‹œå¸ˆå­¦è‰º"ï¼š

```csharp
// Page1ViewModel.cs
public class Page1ViewModel : ViewModelBase // ç»§æ‰¿åŸºç±»
{
    private string _message = "Hello";
    
    public string Message
    {
        get => _message;
        set => SetProperty(ref _message, value); // ä½¿ç”¨åŸºç±»æä¾›çš„æ–¹æ³•
    }
}
```

è¿™æ ·åšçš„å¥½å¤„ï¼š
- ğŸš€ ä¸éœ€è¦é‡å¤å®ç°å±æ€§é€šçŸ¥é€»è¾‘
- ğŸ›¡ï¸ ä¿è¯æ‰€æœ‰ViewModelè¡Œä¸ºä¸€è‡´
- ğŸ“¦ æ–¹ä¾¿æœªæ¥æ·»åŠ å…¬å…±åŠŸèƒ½

## å†…éƒ¨ä¿®ç‚¼å›¾è§£

åŸºç±»å¦‚ä½•å¸®åŠ©å±æ€§æ›´æ–°ï¼š

```mermaid
sequenceDiagram
    participant V as è§†å›¾
    participant VM as å…·ä½“ViewModel
    participant B as ViewModelåŸºç±»
    participant S as ç³»ç»Ÿç»‘å®š

    V->>VM: ç”¨æˆ·ä¿®æ”¹ç•Œé¢å€¼
    VM->>B: è°ƒç”¨SetProperty()
    B->>S: å‘å‡ºå±æ€§å˜æ›´é€šçŸ¥
    S->>V: æ›´æ–°ç•Œé¢æ˜¾ç¤º
```

## æ‰©å±•åŸºç¡€åŠŸèƒ½

### æ·»åŠ å…¨å±€LoadingçŠ¶æ€

åœ¨åŸºç±»ä¸­æ·»åŠ å…¬å…±åŠŸèƒ½ï¼š

```csharp
// åœ¨ViewModelBaseä¸­æ·»åŠ 
private bool _isLoading;
public bool IsLoading
{
    get => _isLoading;
    set => SetProperty(ref _isLoading, value);
}

public virtual void OnNavigatedTo() {} // å¯è¢«å­ç±»é‡å†™çš„å¯¼èˆªæ–¹æ³•
```

ç°åœ¨æ‰€æœ‰é¡µé¢éƒ½èƒ½ï¼š
1. ä½¿ç”¨`IsLoading`æ§åˆ¶åŠ è½½çŠ¶æ€
2. å®ç°`OnNavigatedTo`å“åº”é¡µé¢å¯¼èˆªäº‹ä»¶

### ä½¿ç”¨ç¤ºä¾‹

```csharp
// Page2ViewModel.cs
public override void OnNavigatedTo()
{
    IsLoading = true;
    // åŠ è½½æ•°æ®...
    IsLoading = false;
}
```

## å¸¸è§é—®é¢˜è§£ç­”

â“ ä¸ºä»€ä¹ˆè¦ç”¨`SetProperty`è€Œä¸æ˜¯ç›´æ¥èµ‹å€¼ï¼Ÿ
- ç›´æ¥èµ‹å€¼ä¸ä¼šè§¦å‘ç•Œé¢æ›´æ–°
- `SetProperty`ä¼šæ£€æŸ¥å€¼æ˜¯å¦å˜åŒ–å¹¶è‡ªåŠ¨é€šçŸ¥

â“ å¯ä»¥å¤šé‡ç»§æ‰¿å—ï¼Ÿ
C#ä¸æ”¯æŒï¼Œä½†å¯ä»¥é€šè¿‡[ä¾èµ–æ³¨å…¥ç³»ç»Ÿ](03_ä¾èµ–æ³¨å…¥ç³»ç»Ÿ_.md)ç»„åˆåŠŸèƒ½

## æ€»ç»“ä¸ç»ƒä¹ 

ä»Šå¤©æˆ‘ä»¬æŒæ¡äº†ï¼š
- è§†å›¾æ¨¡å‹åŸºç±»çš„æ ¸å¿ƒä½œç”¨
- `ObservableObject`æä¾›çš„å¼ºå¤§èƒ½åŠ›
- å¦‚ä½•æ‰©å±•å…¬å…±åŠŸèƒ½

åŠ¨æ‰‹å°è¯•ï¼š
1. åœ¨åŸºç±»æ·»åŠ `Title`å…¬å…±å±æ€§
2. è®©æ‰€æœ‰é¡µé¢è‡ªåŠ¨æ˜¾ç¤ºç»Ÿä¸€é¡µè„š

ä¸‹èŠ‚è¯¾æˆ‘ä»¬å°†å­¦ä¹ [è§†å›¾å®šä½å™¨](07_è§†å›¾å®šä½å™¨_.md)ï¼Œäº†è§£å¦‚ä½•è‡ªåŠ¨åŒ¹é…è§†å›¾å’ŒViewModelï¼

---

Generated by [AI Codebase Knowledge Builder](https://github.com/The-Pocket/Tutorial-Codebase-Knowledge)