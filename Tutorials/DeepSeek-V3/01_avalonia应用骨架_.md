# Chapter 1: Avaloniaåº”ç”¨éª¨æ¶


## ä¸ºä»€ä¹ˆéœ€è¦åº”ç”¨éª¨æ¶ï¼Ÿ

æƒ³è±¡ä½ æ­£åœ¨æ­å»ºä¸€åº§æˆ¿å­ğŸ â€”â€”åœ¨ç Œå¢™å’Œè£…é—¨çª—ä¹‹å‰ï¼Œéœ€è¦å…ˆæ‰“å¥½åœ°åŸºã€æ­å¥½æ¢æŸ±ã€‚Avaloniaåº”ç”¨éª¨æ¶æ­£æ˜¯è¿™æ ·çš„åŸºç¡€ç»“æ„ï¼Œå®ƒè´Ÿè´£ï¼š

1. ğŸ—ï¸ åˆå§‹åŒ–æ•´ä¸ªåº”ç”¨çš„è¿è¡Œç¯å¢ƒ
2. ğŸ’¡ é…ç½®ä¸»é¢˜æ ·å¼ï¼ˆæ¯”å¦‚äº®è‰²/æš—è‰²æ¨¡å¼ï¼‰
3. â±ï¸ ç®¡ç†åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸ
4. ğŸ–¼ï¸ åˆ›å»ºä¸»çª—å£å¹¶ç»‘å®šæ•°æ®ä¸Šä¸‹æ–‡

## æœ€å°åŒ–åº”ç”¨éª¨æ¶ç¤ºä¾‹

è®©æˆ‘ä»¬çœ‹çœ‹æœ€ç®€å•çš„Avaloniaåº”ç”¨éª¨æ¶é•¿ä»€ä¹ˆæ ·ï¼š

```csharp
// App.axaml.cs
public partial class App : Application
{
    public override void Initialize()
    {
        AvaloniaXamlLoader.Load(this); // åŠ è½½XAMLç•Œé¢å®šä¹‰
    }

    public override void OnFrameworkInitializationCompleted()
    {
        if (ApplicationLifetime is IClassicDesktopStyleApplicationLifetime desktop)
        {
            desktop.MainWindow = new MainWindow() // åˆ›å»ºä¸»çª—å£
            {
                DataContext = new MainWindowViewModel() // ç»‘å®šViewModel
            };
        }
        base.OnFrameworkInitializationCompleted();
    }
}
```

è¿™æ®µä»£ç åšäº†ä¸‰ä»¶äº‹ï¼š
1. é€šè¿‡`Initialize()`åŠ è½½ç•Œé¢å®šä¹‰
2. åº”ç”¨å¯åŠ¨å®Œæˆååˆ›å»ºä¸»çª—å£
3. ä¸ºä¸»çª—å£ç»‘å®šViewModelï¼ˆæ•°æ®ä¸Šä¸‹æ–‡ï¼‰

## éª¨æ¶çš„å…³é”®éƒ¨ä»¶æ‹†è§£

### 1. Applicationç±»
è¿™æ˜¯Avaloniaåº”ç”¨çš„"å¤§è„‘"ï¼Œç»§æ‰¿è‡ª`Avalonia.Application`ã€‚å°±åƒäººä½“çš„ä¸­æ¢ç¥ç»ç³»ç»Ÿï¼Œå®ƒåè°ƒç€æ•´ä¸ªåº”ç”¨çš„è¿è¡Œã€‚

### 2. XAMLé…ç½®æ–‡ä»¶
```xml
<!-- App.axaml -->
<Application xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             x:Class="MyApp.App">
    <Application.Styles>
        <FluentTheme /> <!-- ä½¿ç”¨Fluentè®¾è®¡é£æ ¼ -->
    </Application.Styles>
</Application>
```
è¿™ä¸ªæ–‡ä»¶åƒè£…ä¿®è®¾è®¡å›¾ï¼Œå®šä¹‰äº†ï¼š
- åº”ç”¨ä½¿ç”¨çš„ä¸»é¢˜ï¼ˆè¿™é‡Œæ˜¯Fluenté£æ ¼ï¼‰
- å…¨å±€èµ„æºï¼ˆåç»­ç« èŠ‚ä¼šä»‹ç»ï¼‰

### 3. ç”Ÿå‘½å‘¨æœŸç®¡ç†
åº”ç”¨éª¨æ¶è¿˜å¤„ç†å„ç§ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ï¼š

| äº‹ä»¶é˜¶æ®µ              | ç”¨é€”                             |
|-----------------------|----------------------------------|
| `Initialize()`        | åŠ è½½XAMLå’Œåˆå§‹åŒ–èµ„æº             |
| `OnFrameworkInitializationCompleted()` | åº”ç”¨å®Œå…¨å¯åŠ¨ååˆ›å»ºä¸»ç•Œé¢ |

## æ·±å…¥ï¼šå¯åŠ¨è¿‡ç¨‹è¯¦è§£

è®©æˆ‘ä»¬ç”¨åºåˆ—å›¾çœ‹çœ‹åº”ç”¨å¯åŠ¨æ—¶çš„å†…éƒ¨æµç¨‹ï¼š

```mermaid
sequenceDiagram
    participant ç³»ç»Ÿ as æ“ä½œç³»ç»Ÿ
    participant App as åº”ç”¨éª¨æ¶
    participant ä¸»çª—å£ as ä¸»çª—å£
    
    ç³»ç»Ÿ->>App: å¯åŠ¨åº”ç”¨ç¨‹åº
    App->>App: Initialize()
    App->>App: OnFrameworkInitializationCompleted()
    App->>ä¸»çª—å£: åˆ›å»ºå®ä¾‹å¹¶æ˜¾ç¤º
    ä¸»çª—å£-->>ç³»ç»Ÿ: å‘ˆç°ç”¨æˆ·ç•Œé¢
```

1. æ“ä½œç³»ç»ŸåŠ è½½ç¨‹åºé›†å¹¶å¯åŠ¨åº”ç”¨
2. åº”ç”¨éª¨æ¶åˆå§‹åŒ–XAMLèµ„æº
3. æ¡†æ¶å®Œå…¨åŠ è½½ååˆ›å»ºä¸»çª—å£
4. ä¸»çª—å£æ˜¾ç¤ºåˆ°å±å¹•

## å®é™…åº”ç”¨ï¼šå¸¦DIçš„éª¨æ¶

ç°åœ¨çœ‹çœ‹æˆ‘ä»¬é¡¹ç›®ä¸­æ›´é«˜çº§çš„å®ç°ï¼ˆç»“åˆäº†[ä¾èµ–æ³¨å…¥æœåŠ¡å®¹å™¨](02_ä¾èµ–æ³¨å…¥æœåŠ¡å®¹å™¨_.md)ï¼‰ï¼š

```csharp
// ä½¿ç”¨æœåŠ¡å®¹å™¨è·å–çª—å£å®ä¾‹
var mainWindow = Program.ServiceProvider?.GetRequiredService<MainWindow>();
var mainViewModel = Program.ServiceProvider?.GetRequiredService<MainWindowViewModel>();

if (mainWindow != null && mainViewModel != null)
{
    mainWindow.DataContext = mainViewModel;
    desktop.MainWindow = mainWindow;
}
```

è¿™ç§æ–¹æ³•çš„å¥½å¤„ï¼š
- ğŸ” è‡ªåŠ¨è§£å†³ä¾èµ–å…³ç³»
- ğŸ”„ æ–¹ä¾¿æ›¿æ¢å®ç°
- ğŸ§© æ¨¡å—åŒ–ç®¡ç†ç»„ä»¶

## å¸¸è§é—®é¢˜è§£ç­”

â“ ä¸ºä»€ä¹ˆéœ€è¦ç¦ç”¨æ•°æ®éªŒè¯æ’ä»¶ï¼Ÿ
```csharp
private void DisableAvaloniaDataAnnotationValidation()
{
    var plugins = BindingPlugins.DataValidators
        .OfType<DataAnnotationsValidationPlugin>().ToArray();
    
    foreach (var plugin in plugins)
    {
        BindingPlugins.DataValidators.Remove(plugin);
    }
}
```
è¿™æ˜¯ä¸ºäº†é¿å…ä¸CommunityToolkitçš„éªŒè¯åŠŸèƒ½å†²çªï¼Œå°±å¥½åƒå…³æ‰ä¸€ä¸ªé‡å¤çš„é—¹é’Ÿâ°

## æ€»ç»“

æœ¬ç« æˆ‘ä»¬å­¦ä¹ äº†ï¼š
- Avaloniaåº”ç”¨éª¨æ¶çš„åŸºç¡€ä½œç”¨
- æ ¸å¿ƒç»„ä»¶å’Œå·¥ä½œåŸç†
- å¦‚ä½•ç»“åˆä¾èµ–æ³¨å…¥æ„å»ºéª¨æ¶

å°±å¥½åƒå­¦ä¼šäº†æˆ¿å±‹å»ºç­‘çš„æ¡†æ¶ç»“æ„ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¦å¾€è¿™ä¸ªéª¨æ¶é‡Œæ·»åŠ " plumbingç®¡é“" â€”â€” [ä¾èµ–æ³¨å…¥æœåŠ¡å®¹å™¨](02_ä¾èµ–æ³¨å…¥æœåŠ¡å®¹å™¨_.md)å°†å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ç®¡ç†å†…éƒ¨ç»„ä»¶ï¼

---

Generated by [AI Codebase Knowledge Builder](https://github.com/The-Pocket/Tutorial-Codebase-Knowledge)